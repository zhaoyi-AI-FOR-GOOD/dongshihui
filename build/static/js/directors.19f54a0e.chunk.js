"use strict";(self.webpackChunkdongshihui_frontend=self.webpackChunkdongshihui_frontend||[]).push([[274],{2060:(e,s,t)=>{t.r(s),t.d(s,{default:()=>E});var r=t(8),i=t(9950),a=t(9808),n=t(6639),l=t(2053),c=t(6491),o=t(8216),d=t(899),x=t(8089),h=t(704),A=t(975),j=t(7324),p=t(9925),m=t(3174),u=t(5277),g=t(4616),y=t(6986),f=t(5546),_=t(1413),v=t(2235),b=t(4801),w=t(7033),C=t(5834),k=t(294),I=t(1974),W=t(2934),S=t(8429),z=t(1920),P=t(5887),M=t(9181),B=t(4414);const E=()=>{var e;const s=(0,S.Zp)(),{id:t}=(0,S.g)(),E=Boolean(t),H=(0,z.useQueryClient)(),[D,L]=(0,i.useState)({name:"",title:"",era:"",avatar_url:"",system_prompt:"",personality_traits:[],core_beliefs:[],speaking_style:"",expertise_areas:[],is_active:!0}),[Q,R]=(0,i.useState)(!1),[V,T]=(0,i.useState)(null),[O,q]=(0,i.useState)(!0),{data:F,isLoading:N}=(0,z.useQuery)(["director",t],()=>M.hV.getById(t),{enabled:E,onSuccess:e=>{const s=e.data.data;L({name:s.name||"",title:s.title||"",era:s.era||"",avatar_url:s.avatar_url||"",system_prompt:s.system_prompt||"",personality_traits:s.personality_traits||[],core_beliefs:s.core_beliefs||[],speaking_style:s.speaking_style||"",expertise_areas:s.expertise_areas||[],is_active:s.is_active})},onError:e=>{P.Ay.error("\u83b7\u53d6\u8463\u4e8b\u4fe1\u606f\u5931\u8d25: "+e.message),s("/directors")}}),U=(0,z.useMutation)(e=>E?M.hV.update(t,e):M.hV.create(e),{onSuccess:()=>{P.Ay.success(E?"\u8463\u4e8b\u66f4\u65b0\u6210\u529f":"\u8463\u4e8b\u521b\u5efa\u6210\u529f"),H.invalidateQueries("directors"),H.invalidateQueries("activeDirectors"),s("/directors")},onError:e=>{P.Ay.error("\u4fdd\u5b58\u5931\u8d25: "+e.message)}}),Z=(0,z.useMutation)(e=>M.hV.createFromPrompt(e,D.avatar_url),{onSuccess:e=>{P.Ay.success("\u667a\u80fd\u521b\u5efa\u6210\u529f\uff01"),H.invalidateQueries("directors"),H.invalidateQueries("activeDirectors"),s("/directors")},onError:e=>{P.Ay.error("\u667a\u80fd\u521b\u5efa\u5931\u8d25: "+e.message)}}),J=(e,s)=>{L(t=>(0,r.A)((0,r.A)({},t),{},{[e]:s}))},G=(e,s)=>{const t=s.split(/[,\uff0c\n]/).map(e=>e.trim()).filter(Boolean);J(e,t)};return N?(0,B.jsxs)(a.A,{maxWidth:"lg",sx:{py:4,textAlign:"center"},children:[(0,B.jsx)(n.A,{size:40}),(0,B.jsx)(l.A,{variant:"h6",sx:{mt:2},children:"\u52a0\u8f7d\u4e2d..."})]}):(0,B.jsxs)(a.A,{maxWidth:"lg",sx:{py:4},children:[(0,B.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",mb:4},children:[(0,B.jsx)(o.A,{startIcon:(0,B.jsx)(b.A,{}),onClick:()=>s("/directors"),sx:{mr:2},children:"\u8fd4\u56de"}),(0,B.jsx)(l.A,{variant:"h4",component:"h1",children:E?"\u7f16\u8f91\u8463\u4e8b":"\u521b\u5efa\u8463\u4e8b"})]}),(0,B.jsxs)("form",{onSubmit:e=>{e.preventDefault(),D.name.trim()&&D.title.trim()&&D.system_prompt.trim()?O&&!E?Z.mutate(D.system_prompt):U.mutate(D):P.Ay.error("\u8bf7\u586b\u5199\u5fc5\u8981\u5b57\u6bb5\uff1a\u59d3\u540d\u3001\u8eab\u4efd\u3001\u4eba\u8bbe\u63d0\u793a\u8bcd")},children:[(0,B.jsxs)(d.Ay,{container:!0,spacing:4,children:[(0,B.jsxs)(d.Ay,{item:!0,xs:12,md:8,children:[(0,B.jsx)(x.A,{children:(0,B.jsxs)(h.A,{children:[(0,B.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,B.jsxs)(l.A,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[(0,B.jsx)(I.A,{}),"\u4eba\u8bbe\u63d0\u793a\u8bcd"]}),!E&&(0,B.jsx)(A.A,{control:(0,B.jsx)(j.A,{checked:O,onChange:e=>q(e.target.checked)}),label:"\u667a\u80fd\u521b\u5efa\u6a21\u5f0f"})]}),(0,B.jsx)(p.A,{multiline:!0,rows:12,fullWidth:!0,placeholder:"\u8bf7\u8f93\u5165\u5386\u53f2\u4eba\u7269\u7684\u4eba\u8bbe\u63cf\u8ff0\uff0c\u4f8b\u5982\uff1a \u4f60\u662f16\u4e16\u7eaa\u7684\u5b97\u6559\u6539\u9769\u9886\u8896\u7ea6\u7ff0\xb7\u52a0\u5c14\u6587\u3002\u4f60\u662f\u4e00\u4f4d\u4e25\u8c28\u7684\u795e\u5b66\u5bb6\uff0c\u63d0\u51fa\u4e86\u9884\u5b9a\u8bba\u601d\u60f3\uff0c\u8ba4\u4e3a\u4e0a\u5e1d\u5df2\u7ecf\u9884\u5148\u786e\u5b9a\u4e86\u6bcf\u4e2a\u4eba\u7684\u6551\u8d4e\u547d\u8fd0\u3002\u4f60\u8bf4\u8bdd\u4e25\u8c28\u3001\u903b\u8f91\u6027\u5f3a\uff0c\u7ecf\u5e38\u5f15\u7528\u300a\u5723\u7ecf\u300b\u6765\u652f\u6301\u4f60\u7684\u89c2\u70b9...",value:D.system_prompt,onChange:e=>J("system_prompt",e.target.value),variant:"outlined",required:!0}),(0,B.jsxs)(c.A,{sx:{mt:2,display:"flex",gap:2},children:[(0,B.jsx)(o.A,{variant:"outlined",startIcon:(0,B.jsx)(w.A,{}),onClick:async()=>{if(D.system_prompt.trim()){R(!0);try{let e,s;E?(e=await M.hV.reparseDirector(t),s=e.data.data,H.invalidateQueries(["director",t]),s.director&&L({name:s.director.name||"",title:s.director.title||"",era:s.director.era||"",avatar_url:s.director.avatar_url||"",system_prompt:s.director.system_prompt||"",personality_traits:s.director.personality_traits||[],core_beliefs:s.director.core_beliefs||[],speaking_style:s.director.speaking_style||"",expertise_areas:s.director.expertise_areas||[],is_active:s.director.is_active}),T({is_ai_generated:s.ai_analysis.is_ai_generated,confidence_score:s.ai_analysis.confidence_score,tokens_used:s.ai_analysis.tokens_used,parsed_info:{name:s.director.name,title:s.director.title,era:s.director.era,personality_traits:s.director.personality_traits,core_beliefs:s.director.core_beliefs,speaking_style:s.director.speaking_style,expertise_areas:s.director.expertise_areas}})):(e=await M.hV.parsePrompt(D.system_prompt),s=e.data.data,T(s),s.parsed_info&&L(e=>(0,r.A)((0,r.A)({},e),{},{name:"\u672a\u77e5\u5386\u53f2\u4eba\u7269"!==s.parsed_info.name?s.parsed_info.name:e.name,title:s.parsed_info.title||e.title,era:s.parsed_info.era||e.era,personality_traits:s.parsed_info.personality_traits||e.personality_traits,core_beliefs:s.parsed_info.core_beliefs||e.core_beliefs,speaking_style:s.parsed_info.speaking_style||e.speaking_style,expertise_areas:s.parsed_info.expertise_areas||e.expertise_areas}))),P.Ay.success(E?"\u91cd\u65b0\u89e3\u6790\u5b8c\u6210\uff01\u8463\u4e8b\u4fe1\u606f\u5df2\u66f4\u65b0":s.is_ai_generated?"AI\u89e3\u6790\u5b8c\u6210\uff01":"\u57fa\u7840\u89e3\u6790\u5b8c\u6210")}catch(e){P.Ay.error("\u89e3\u6790\u5931\u8d25: "+e.message)}finally{R(!1)}}else P.Ay.error("\u8bf7\u5148\u8f93\u5165\u4eba\u8bbe\u63d0\u793a\u8bcd")},disabled:Q||!D.system_prompt.trim(),children:Q?"\u89e3\u6790\u4e2d...":E?"\u91cd\u65b0\u89e3\u6790":"AI\u89e3\u6790"}),!E&&O&&(0,B.jsx)(m.A,{severity:"info",sx:{flex:1},children:"\u667a\u80fd\u521b\u5efa\u6a21\u5f0f\uff1a\u7cfb\u7edf\u5c06\u81ea\u52a8\u89e3\u6790\u63d0\u793a\u8bcd\u5e76\u521b\u5efa\u8463\u4e8b\uff0c\u65e0\u9700\u624b\u52a8\u586b\u5199\u5176\u4ed6\u4fe1\u606f"}),E&&(0,B.jsx)(m.A,{severity:"info",sx:{flex:1},children:"\u7f16\u8f91\u6a21\u5f0f\uff1a\u53ef\u4ee5\u91cd\u65b0\u89e3\u6790\u4eba\u8bbe\u63d0\u793a\u8bcd\u6765\u66f4\u65b0\u8463\u4e8b\u7684AI\u751f\u6210\u5b57\u6bb5"})]})]})}),V&&(0,B.jsx)(x.A,{sx:{mt:3},children:(0,B.jsxs)(h.A,{children:[(0,B.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"AI\u89e3\u6790\u7ed3\u679c"}),(0,B.jsx)(m.A,{severity:V.is_ai_generated?"success":"warning",sx:{mb:2},children:V.is_ai_generated?"AI\u89e3\u6790\u6210\u529f (\u7f6e\u4fe1\u5ea6: ".concat(Math.round(100*V.confidence_score),"%)"):V.warning||"\u4f7f\u7528\u57fa\u7840\u5173\u952e\u8bcd\u5339\u914d"}),V.parsed_info&&(0,B.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,B.jsxs)(d.Ay,{item:!0,xs:12,sm:6,children:[(0,B.jsx)(l.A,{variant:"subtitle2",children:"\u59d3\u540d"}),(0,B.jsx)(l.A,{variant:"body2",color:"text.secondary",children:V.parsed_info.name})]}),(0,B.jsxs)(d.Ay,{item:!0,xs:12,sm:6,children:[(0,B.jsx)(l.A,{variant:"subtitle2",children:"\u8eab\u4efd"}),(0,B.jsx)(l.A,{variant:"body2",color:"text.secondary",children:V.parsed_info.title})]}),(0,B.jsxs)(d.Ay,{item:!0,xs:12,children:[(0,B.jsx)(l.A,{variant:"subtitle2",children:"\u6838\u5fc3\u89c2\u70b9"}),(0,B.jsx)(c.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:.5},children:null===(e=V.parsed_info.core_beliefs)||void 0===e?void 0:e.map((e,s)=>(0,B.jsx)(u.A,{label:e,size:"small"},s))})]})]})]})})]}),(0,B.jsx)(d.Ay,{item:!0,xs:12,md:4,children:(0,B.jsx)(x.A,{children:(0,B.jsxs)(h.A,{children:[(0,B.jsxs)(l.A,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1,mb:3},children:[(0,B.jsx)(k.A,{}),"\u8463\u4e8b\u4fe1\u606f"]}),(0,B.jsxs)(c.A,{sx:{mb:3},children:[(0,B.jsx)(p.A,{fullWidth:!0,label:"\u59d3\u540d *",value:D.name,onChange:e=>J("name",e.target.value),sx:{mb:2},required:!0}),(0,B.jsx)(p.A,{fullWidth:!0,label:"\u8eab\u4efd/\u5934\u8854 *",value:D.title,onChange:e=>J("title",e.target.value),sx:{mb:2},required:!0}),(0,B.jsx)(p.A,{fullWidth:!0,label:"\u5386\u53f2\u65f6\u4ee3",value:D.era,onChange:e=>J("era",e.target.value),placeholder:"\u5982\uff1a20\u4e16\u7eaa (1879-1955)",sx:{mb:2}}),(0,B.jsx)(p.A,{fullWidth:!0,label:"\u5934\u50cfURL",value:D.avatar_url,onChange:e=>J("avatar_url",e.target.value),placeholder:"\u53ef\u9009\u7684\u5934\u50cf\u56fe\u7247\u94fe\u63a5"})]}),(0,B.jsxs)(g.A,{children:[(0,B.jsx)(y.A,{expandIcon:(0,B.jsx)(C.A,{}),children:(0,B.jsx)(l.A,{children:"\u8be6\u7ec6\u7279\u5f81"})}),(0,B.jsxs)(f.A,{children:[(0,B.jsx)(p.A,{fullWidth:!0,label:"\u6027\u683c\u7279\u5f81",multiline:!0,rows:2,value:D.personality_traits.join(", "),onChange:e=>G("personality_traits",e.target.value),placeholder:"\u5982\uff1a\u597d\u5947\u5fc3\u5f3a, \u72ec\u7acb\u601d\u8003, \u5bcc\u6709\u60f3\u8c61\u529b",helperText:"\u7528\u9017\u53f7\u5206\u9694\u591a\u4e2a\u7279\u5f81",sx:{mb:2}}),(0,B.jsx)(p.A,{fullWidth:!0,label:"\u6838\u5fc3\u4fe1\u5ff5",multiline:!0,rows:2,value:D.core_beliefs.join(", "),onChange:e=>G("core_beliefs",e.target.value),placeholder:"\u5982\uff1a\u79d1\u5b66\u7406\u6027, \u8ffd\u6c42\u771f\u7406, \u8d28\u7591\u6743\u5a01",helperText:"\u7528\u9017\u53f7\u5206\u9694\u591a\u4e2a\u4fe1\u5ff5",sx:{mb:2}}),(0,B.jsx)(p.A,{fullWidth:!0,label:"\u8bf4\u8bdd\u98ce\u683c",value:D.speaking_style,onChange:e=>J("speaking_style",e.target.value),placeholder:"\u5982\uff1a\u5e7d\u9ed8\u98ce\u8da3\u3001\u5584\u4e8e\u7528\u6bd4\u55bb",sx:{mb:2}}),(0,B.jsx)(p.A,{fullWidth:!0,label:"\u4e13\u4e1a\u9886\u57df",multiline:!0,rows:2,value:D.expertise_areas.join(", "),onChange:e=>G("expertise_areas",e.target.value),placeholder:"\u5982\uff1a\u7406\u8bba\u7269\u7406, \u6570\u5b66, \u54f2\u5b66",helperText:"\u7528\u9017\u53f7\u5206\u9694\u591a\u4e2a\u9886\u57df"})]})]}),(D.name||D.title)&&(0,B.jsxs)(c.A,{sx:{mt:3,p:2,bgcolor:"background.default",borderRadius:2},children:[(0,B.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:"\u8463\u4e8b\u9884\u89c8"}),(0,B.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,B.jsx)(_.A,{src:D.avatar_url,children:(0,B.jsx)(k.A,{})}),(0,B.jsxs)(c.A,{children:[(0,B.jsx)(l.A,{variant:"subtitle1",children:D.name||"\u672a\u8bbe\u7f6e\u59d3\u540d"}),(0,B.jsx)(l.A,{variant:"body2",color:"text.secondary",children:D.title||"\u672a\u8bbe\u7f6e\u8eab\u4efd"}),D.era&&(0,B.jsx)(l.A,{variant:"caption",color:"text.secondary",children:D.era})]})]})]})]})})})]}),(0,B.jsxs)(v.A,{sx:{p:3,mt:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,B.jsx)(o.A,{variant:"outlined",onClick:()=>s("/directors"),children:"\u53d6\u6d88"}),(0,B.jsxs)(c.A,{sx:{display:"flex",gap:2},children:[!E&&!O&&(0,B.jsx)(o.A,{variant:"outlined",startIcon:(0,B.jsx)(w.A,{}),onClick:()=>q(!0),children:"\u5207\u6362\u667a\u80fd\u6a21\u5f0f"}),(0,B.jsx)(o.A,{type:"submit",variant:"contained",startIcon:(0,B.jsx)(W.A,{}),disabled:U.isLoading||Z.isLoading,children:U.isLoading||Z.isLoading?"\u4fdd\u5b58\u4e2d...":E?"\u66f4\u65b0\u8463\u4e8b":O?"\u667a\u80fd\u521b\u5efa":"\u521b\u5efa\u8463\u4e8b"})]})]})]})]})}},2100:(e,s,t)=>{t.r(s),t.d(s,{default:()=>W});t(9950);var r=t(9808),i=t(2053),a=t(3174),n=t(6491),l=t(8216),c=t(899),o=t(8089),d=t(704),x=t(1413),h=t(4745),A=t(5277),j=t(2235),p=t(4320),m=t(4801),u=t(379),g=t(294),y=t(1974),f=t(6299),_=t(8429),v=t(1920),b=t(1521),w=t(922),C=t(5887),k=t(9181),I=t(4414);const W=()=>{var e;const s=(0,_.Zp)(),{id:t}=(0,_.g)(),{data:W,isLoading:S,error:z}=(0,v.useQuery)(["director",t],()=>k.hV.getById(t),{onError:e=>{C.Ay.error("\u83b7\u53d6\u8463\u4e8b\u8be6\u60c5\u5931\u8d25: "+e.message),s("/directors")}}),P=null===W||void 0===W||null===(e=W.data)||void 0===e?void 0:e.data;return S?(0,I.jsx)(r.A,{maxWidth:"lg",sx:{py:4,textAlign:"center"},children:(0,I.jsx)(i.A,{variant:"h6",children:"\u52a0\u8f7d\u4e2d..."})}):z||!P?(0,I.jsx)(r.A,{maxWidth:"lg",sx:{py:4},children:(0,I.jsx)(a.A,{severity:"error",children:"\u52a0\u8f7d\u8463\u4e8b\u8be6\u60c5\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"})}):(0,I.jsxs)(r.A,{maxWidth:"lg",sx:{py:4},children:[(0,I.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:4},children:[(0,I.jsxs)(n.A,{sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(l.A,{startIcon:(0,I.jsx)(m.A,{}),onClick:()=>s("/directors"),sx:{mr:2},children:"\u8fd4\u56de"}),(0,I.jsx)(i.A,{variant:"h4",component:"h1",children:"\u8463\u4e8b\u8be6\u60c5"})]}),(0,I.jsx)(l.A,{variant:"contained",startIcon:(0,I.jsx)(u.A,{}),onClick:()=>s("/directors/edit/".concat(P.id)),children:"\u7f16\u8f91\u8463\u4e8b"})]}),(0,I.jsxs)(c.Ay,{container:!0,spacing:4,children:[(0,I.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,I.jsx)(o.A,{children:(0,I.jsxs)(d.A,{children:[(0,I.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,I.jsx)(x.A,{src:P.avatar_url,sx:{width:80,height:80,mr:2},children:(0,I.jsx)(g.A,{sx:{fontSize:40}})}),(0,I.jsxs)(n.A,{children:[(0,I.jsx)(i.A,{variant:"h5",gutterBottom:!0,children:P.name}),(0,I.jsx)(i.A,{variant:"subtitle1",color:"text.secondary",children:P.title}),P.era&&(0,I.jsx)(i.A,{variant:"body2",color:"text.secondary",children:P.era})]})]}),(0,I.jsx)(h.A,{sx:{mb:3}}),(0,I.jsxs)(n.A,{sx:{mb:3},children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"\u57fa\u672c\u4fe1\u606f"}),(0,I.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,I.jsx)(p.A,{sx:{mr:1,fontSize:16}}),(0,I.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["\u521b\u5efa\u65f6\u95f4: ",(0,b.A)(new Date(P.createdAt),"yyyy-MM-dd HH:mm",{locale:w.A})]})]}),P.updatedAt!==P.createdAt&&(0,I.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,I.jsx)(p.A,{sx:{mr:1,fontSize:16}}),(0,I.jsxs)(i.A,{variant:"body2",color:"text.secondary",children:["\u66f4\u65b0\u65f6\u95f4: ",(0,b.A)(new Date(P.updatedAt),"yyyy-MM-dd HH:mm",{locale:w.A})]})]})]}),(0,I.jsx)(h.A,{sx:{mb:3}}),(0,I.jsxs)(n.A,{children:[(0,I.jsxs)(i.A,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(f.A,{sx:{mr:1}}),"\u6d3b\u52a8\u7edf\u8ba1"]}),(0,I.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,I.jsx)(i.A,{variant:"body2",children:"\u53d1\u8a00\u6b21\u6570"}),(0,I.jsx)(i.A,{variant:"body2",fontWeight:"bold",children:P.total_statements})]}),(0,I.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,I.jsx)(i.A,{variant:"body2",children:"\u53c2\u4e0e\u4f1a\u8bae"}),(0,I.jsx)(i.A,{variant:"body2",fontWeight:"bold",children:P.total_meetings})]})]})]})})}),(0,I.jsxs)(c.Ay,{item:!0,xs:12,md:8,children:[(0,I.jsx)(o.A,{sx:{mb:3},children:(0,I.jsxs)(d.A,{children:[(0,I.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"\u4eba\u7269\u7279\u5f81"}),P.personality_traits&&P.personality_traits.length>0&&(0,I.jsxs)(n.A,{sx:{mb:3},children:[(0,I.jsx)(i.A,{variant:"subtitle2",gutterBottom:!0,children:"\u6027\u683c\u7279\u5f81"}),(0,I.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:P.personality_traits.map((e,s)=>(0,I.jsx)(A.A,{label:e,variant:"outlined",size:"small"},s))})]}),P.core_beliefs&&P.core_beliefs.length>0&&(0,I.jsxs)(n.A,{sx:{mb:3},children:[(0,I.jsx)(i.A,{variant:"subtitle2",gutterBottom:!0,children:"\u6838\u5fc3\u4fe1\u5ff5"}),(0,I.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:P.core_beliefs.map((e,s)=>(0,I.jsx)(A.A,{label:e,color:"primary",size:"small"},s))})]}),P.expertise_areas&&P.expertise_areas.length>0&&(0,I.jsxs)(n.A,{sx:{mb:3},children:[(0,I.jsx)(i.A,{variant:"subtitle2",gutterBottom:!0,children:"\u4e13\u4e1a\u9886\u57df"}),(0,I.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:P.expertise_areas.map((e,s)=>(0,I.jsx)(A.A,{label:e,color:"secondary",size:"small"},s))})]}),P.speaking_style&&(0,I.jsxs)(n.A,{children:[(0,I.jsx)(i.A,{variant:"subtitle2",gutterBottom:!0,children:"\u8bf4\u8bdd\u98ce\u683c"}),(0,I.jsx)(i.A,{variant:"body2",color:"text.secondary",children:P.speaking_style})]})]})}),(0,I.jsx)(o.A,{children:(0,I.jsxs)(d.A,{children:[(0,I.jsxs)(i.A,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(y.A,{sx:{mr:1}}),"\u4eba\u8bbe\u63d0\u793a\u8bcd"]}),P.system_prompt?(0,I.jsx)(j.A,{variant:"outlined",sx:{p:2,backgroundColor:"#f5f5f5",border:"1px solid #e0e0e0",maxHeight:400,overflow:"auto"},children:(0,I.jsx)(i.A,{variant:"body2",component:"pre",sx:{whiteSpace:"pre-wrap",fontFamily:'Monaco, Consolas, "Courier New", monospace',fontSize:"13px",lineHeight:1.6,color:"#333333",margin:0,fontWeight:400},children:P.system_prompt})}):(0,I.jsx)(a.A,{severity:"info",children:"\u6682\u65e0\u4eba\u8bbe\u63d0\u793a\u8bcd"}),P.metadata&&(0,I.jsx)(n.A,{sx:{mt:2},children:(0,I.jsxs)(i.A,{variant:"caption",color:"text.secondary",children:["AI\u5206\u6790: ",P.metadata.ai_generated?"\u5df2\u542f\u7528":"\u672a\u542f\u7528",P.metadata.confidence_score&&" (\u7f6e\u4fe1\u5ea6: ".concat(Math.round(100*P.metadata.confidence_score),"%)"),P.metadata.tokens_used&&" | \u4f7f\u7528Token: ".concat(P.metadata.tokens_used)]})})]})})]})]})]})}},7441:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Z});var r=t(9950),i=t(6589),a=t(5277),n=t(9808),l=t(6491),c=t(2053),o=t(8216),d=t(2235),x=t(9925),h=t(2046),A=t(1408),j=t(1320),p=t(5769),m=t(9780),u=t(9213),g=t(1671),y=t(3038),f=t(4075),_=t(1413),v=t(5333),b=t(1434),w=t(899),C=t(8089),k=t(704),I=t(5365),W=t(3266),S=t(3464),z=t(33),P=t(8170),M=t(9739),B=t(4857),E=t(3256),H=t(379),D=t(6281),L=t(294),Q=t(9715),R=t(5810),V=t(1920),T=t(8429),O=t(1521),q=t(922),F=t(5887),N=t(9181),U=t(4414);const Z=()=>{var e,s;const t=(0,T.Zp)(),Z=(0,V.useQueryClient)(),J=(0,B.A)(),G=(0,i.A)(J.breakpoints.down("md")),[Y,K]=(0,r.useState)(0),[X,$]=(0,r.useState)(10),[ee,se]=(0,r.useState)(""),[te,re]=(0,r.useState)([]),[ie,ae]=(0,r.useState)({open:!1,director:null}),[ne,le]=(0,r.useState)({anchorEl:null,director:null}),{data:ce,isLoading:oe}=(0,V.useQuery)(["directors",Y,X,ee],()=>N.hV.getAll(),{onError:e=>{F.Ay.error("\u83b7\u53d6\u8463\u4e8b\u5217\u8868\u5931\u8d25: "+e.message)}}),de=((null===ce||void 0===ce||null===(e=ce.data)||void 0===e?void 0:e.data)||[]).filter(e=>!ee||e.name.toLowerCase().includes(ee.toLowerCase())||e.title.toLowerCase().includes(ee.toLowerCase())),xe=de.slice(Y*X,(Y+1)*X),he=de.length,Ae=(0,V.useMutation)(e=>N.hV.delete(e),{onSuccess:()=>{F.Ay.success("\u8463\u4e8b\u5220\u9664\u6210\u529f"),Z.invalidateQueries("directors"),ae({open:!1,director:null})},onError:e=>{F.Ay.error("\u5220\u9664\u5931\u8d25: "+e.message)}}),je=(0,V.useMutation)(e=>{let{ids:s,status:t,isActive:r}=e;return N.hV.batchUpdateStatus(s,t,r)},{onSuccess:e=>{F.Ay.success("\u6210\u529f\u66f4\u65b0 ".concat(e.data.updated_count," \u4e2a\u8463\u4e8b")),Z.invalidateQueries("directors"),re([])},onError:e=>{F.Ay.error("\u6279\u91cf\u66f4\u65b0\u5931\u8d25: "+e.message)}}),pe=e=>{re(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},me=e=>{if(!e.is_active)return(0,U.jsx)(a.A,{label:"\u5df2\u7981\u7528",color:"error",size:"small"});switch(e.status){case"active":return(0,U.jsx)(a.A,{label:"\u6d3b\u8dc3",color:"success",size:"small"});case"inactive":return(0,U.jsx)(a.A,{label:"\u975e\u6d3b\u8dc3",color:"warning",size:"small"});case"retired":return(0,U.jsx)(a.A,{label:"\u5df2\u9000\u4f11",color:"default",size:"small"});default:return(0,U.jsx)(a.A,{label:e.status,color:"default",size:"small"})}};return(0,U.jsxs)(n.A,{maxWidth:"lg",sx:{py:G?2:4},children:[(0,U.jsxs)(l.A,{sx:{display:"flex",flexDirection:G?"column":"row",justifyContent:"space-between",alignItems:G?"stretch":"center",gap:G?2:0,mb:G?3:4},children:[(0,U.jsx)(c.A,{variant:G?"h5":"h4",component:"h1",children:"\u8463\u4e8b\u7ba1\u7406"}),(0,U.jsxs)(l.A,{sx:{display:"flex",gap:G?1:2,flexDirection:G?"column":"row"},children:[(0,U.jsx)(o.A,{variant:"outlined",startIcon:(0,U.jsx)(R.A,{}),onClick:()=>(0,F.Ay)("\u6279\u91cf\u5bfc\u5165\u529f\u80fd\u5f00\u53d1\u4e2d..."),size:G?"large":"medium",fullWidth:G,sx:{minHeight:G?48:"auto"},children:"\u6279\u91cf\u5bfc\u5165"}),(0,U.jsx)(o.A,{variant:"contained",startIcon:(0,U.jsx)(E.A,{}),onClick:()=>t("/directors/create"),size:G?"large":"medium",fullWidth:G,sx:{minHeight:G?48:"auto"},children:"\u521b\u5efa\u8463\u4e8b"})]})]}),(0,U.jsxs)(d.A,{sx:{p:G?2:3,mb:G?2:3},children:[(0,U.jsx)(l.A,{sx:{display:"flex",gap:2,alignItems:"center",mb:2,flexDirection:G?"column":"row"},children:(0,U.jsx)(x.A,{placeholder:"\u641c\u7d22\u8463\u4e8b\u59d3\u540d\u6216\u8eab\u4efd...",value:ee,onChange:e=>{se(e.target.value),K(0)},InputProps:{startAdornment:(0,U.jsx)(h.A,{position:"start",children:(0,U.jsx)(Q.A,{})})},sx:{flexGrow:1},fullWidth:G,size:"medium"})}),te.length>0&&(0,U.jsxs)(l.A,{sx:{display:"flex",gap:G?1:2,alignItems:"center",flexDirection:G?"column":"row",alignItems:G?"stretch":"center"},children:[(0,U.jsxs)(c.A,{variant:"body2",sx:{textAlign:G?"center":"left"},children:["\u5df2\u9009\u62e9 ",te.length," \u4e2a\u8463\u4e8b"]}),(0,U.jsxs)(l.A,{sx:{display:"flex",gap:1,flexDirection:G?"column":"row",width:G?"100%":"auto"},children:[(0,U.jsx)(o.A,{size:G?"medium":"small",onClick:()=>je.mutate({ids:te,is_active:!1}),fullWidth:G,sx:{minHeight:G?44:"auto"},children:"\u6279\u91cf\u7981\u7528"}),(0,U.jsx)(o.A,{size:G?"medium":"small",onClick:()=>je.mutate({ids:te,is_active:!0,status:"active"}),fullWidth:G,sx:{minHeight:G?44:"auto"},children:"\u6279\u91cf\u542f\u7528"}),(0,U.jsx)(o.A,{size:G?"medium":"small",color:"error",onClick:()=>{F.Ay.error("\u6279\u91cf\u5220\u9664\u529f\u80fd\u9700\u8981\u4e8c\u6b21\u786e\u8ba4")},fullWidth:G,sx:{minHeight:G?44:"auto"},children:"\u6279\u91cf\u5220\u9664"})]})]})]}),(0,U.jsx)(A.A,{mdDown:!0,children:(0,U.jsxs)(j.A,{component:d.A,children:[(0,U.jsxs)(p.A,{children:[(0,U.jsx)(m.A,{children:(0,U.jsxs)(u.A,{children:[(0,U.jsx)(g.A,{padding:"checkbox",children:(0,U.jsx)(y.A,{indeterminate:te.length>0&&te.length<xe.length,checked:xe.length>0&&te.length===xe.length,onChange:e=>{e.target.checked?re(xe.map(e=>e.id)):re([])}})}),(0,U.jsx)(g.A,{children:"\u8463\u4e8b"}),(0,U.jsx)(g.A,{children:"\u8eab\u4efd"}),(0,U.jsx)(g.A,{children:"\u65f6\u4ee3"}),(0,U.jsx)(g.A,{children:"\u72b6\u6001"}),(0,U.jsx)(g.A,{align:"center",children:"\u7edf\u8ba1"}),(0,U.jsx)(g.A,{children:"\u521b\u5efa\u65f6\u95f4"}),(0,U.jsx)(g.A,{align:"center",children:"\u64cd\u4f5c"})]})}),(0,U.jsx)(f.A,{children:oe?[...Array(5)].map((e,s)=>(0,U.jsx)(u.A,{children:(0,U.jsx)(g.A,{colSpan:8,sx:{textAlign:"center",py:4},children:"\u52a0\u8f7d\u4e2d..."})},s)):0===xe.length?(0,U.jsx)(u.A,{children:(0,U.jsxs)(g.A,{colSpan:8,sx:{textAlign:"center",py:8},children:[(0,U.jsx)(L.A,{sx:{fontSize:48,color:"text.secondary",mb:2}}),(0,U.jsx)(c.A,{variant:"body1",color:"text.secondary",children:ee?"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u8463\u4e8b":'\u8fd8\u6ca1\u6709\u8463\u4e8b\uff0c\u70b9\u51fb"\u521b\u5efa\u8463\u4e8b"\u5f00\u59cb\u6dfb\u52a0'})]})}):xe.map(e=>(0,U.jsxs)(u.A,{selected:te.includes(e.id),children:[(0,U.jsx)(g.A,{padding:"checkbox",children:(0,U.jsx)(y.A,{checked:te.includes(e.id),onChange:()=>pe(e.id)})}),(0,U.jsx)(g.A,{children:(0,U.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,U.jsx)(_.A,{src:e.avatar_url,sx:{width:40,height:40},children:(0,U.jsx)(L.A,{})}),(0,U.jsxs)(l.A,{children:[(0,U.jsx)(c.A,{variant:"subtitle2",children:e.name}),e.expertise_areas&&(0,U.jsx)(c.A,{variant:"caption",color:"text.secondary",children:("string"===typeof e.expertise_areas?JSON.parse(e.expertise_areas):e.expertise_areas).slice(0,2).join(", ")})]})]})}),(0,U.jsx)(g.A,{children:(0,U.jsx)(c.A,{variant:"body2",children:e.title})}),(0,U.jsx)(g.A,{children:(0,U.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.era||"-"})}),(0,U.jsx)(g.A,{children:me(e)}),(0,U.jsx)(g.A,{align:"center",children:(0,U.jsxs)(l.A,{children:[(0,U.jsxs)(c.A,{variant:"body2",children:[e.total_statements," \u53d1\u8a00"]}),(0,U.jsxs)(c.A,{variant:"caption",color:"text.secondary",children:[e.total_meetings," \u4f1a\u8bae"]})]})}),(0,U.jsx)(g.A,{children:(0,U.jsx)(c.A,{variant:"body2",color:"text.secondary",children:(0,O.A)(new Date(e.created_at),"yyyy-MM-dd HH:mm",{locale:q.A})})}),(0,U.jsxs)(g.A,{align:"center",children:[(0,U.jsx)(v.A,{onClick:()=>t("/directors/edit/".concat(e.id)),title:"\u7f16\u8f91\u8463\u4e8b",children:(0,U.jsx)(H.A,{})}),(0,U.jsx)(v.A,{onClick:s=>le({anchorEl:s.currentTarget,director:e}),title:"\u66f4\u591a\u64cd\u4f5c",children:(0,U.jsx)(D.A,{})})]})]},e.id))})]}),(0,U.jsx)(b.A,{component:"div",count:he,page:Y,onPageChange:(e,s)=>K(s),rowsPerPage:X,onRowsPerPageChange:e=>{$(parseInt(e.target.value,10)),K(0)},rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"\u6bcf\u9875\u663e\u793a:",labelDisplayedRows:e=>{let{from:s,to:t,count:r}=e;return"".concat(s,"-").concat(t," \u5171 ").concat(r," \u6761")}})]})}),(0,U.jsx)(A.A,{mdUp:!0,children:oe?(0,U.jsx)(d.A,{sx:{p:4,textAlign:"center"},children:(0,U.jsx)(c.A,{variant:"h6",children:"\u52a0\u8f7d\u8463\u4e8b\u5217\u8868\u4e2d..."})}):0===xe.length?(0,U.jsxs)(d.A,{sx:{p:6,textAlign:"center"},children:[(0,U.jsx)(L.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,U.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:ee?"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u8463\u4e8b":"\u8fd8\u6ca1\u6709\u8463\u4e8b"}),(0,U.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:ee?"\u5c1d\u8bd5\u8c03\u6574\u641c\u7d22\u6761\u4ef6":"\u521b\u5efa\u7b2c\u4e00\u4e2a\u8463\u4e8b\u5f00\u59cb\u7ba1\u7406"}),(0,U.jsx)(o.A,{variant:"contained",onClick:()=>t("/directors/create"),children:"\u521b\u5efa\u8463\u4e8b"})]}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(w.Ay,{container:!0,spacing:2,children:xe.map(e=>(0,U.jsx)(w.Ay,{item:!0,xs:12,children:(0,U.jsx)(C.A,{sx:{transition:"all 0.2s ease","&:hover":{boxShadow:"0 6px 20px rgba(0,0,0,0.1)",transform:"translateY(-2px)"}},children:(0,U.jsxs)(k.A,{sx:{p:2.5},children:[(0,U.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,U.jsx)(y.A,{checked:te.includes(e.id),onChange:()=>pe(e.id),sx:{mr:1}}),(0,U.jsx)(_.A,{src:e.avatar_url,sx:{width:48,height:48,mr:2},children:(0,U.jsx)(L.A,{})}),(0,U.jsxs)(l.A,{sx:{flex:1},children:[(0,U.jsx)(c.A,{variant:"h6",sx:{fontWeight:600,fontSize:"1.1rem"},children:e.name}),(0,U.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.title})]}),(0,U.jsxs)(l.A,{sx:{display:"flex",gap:1},children:[(0,U.jsx)(v.A,{onClick:()=>t("/directors/edit/".concat(e.id)),title:"\u7f16\u8f91\u8463\u4e8b",size:"large",sx:{minHeight:44,minWidth:44},children:(0,U.jsx)(H.A,{})}),(0,U.jsx)(v.A,{onClick:s=>le({anchorEl:s.currentTarget,director:e}),title:"\u66f4\u591a\u64cd\u4f5c",size:"large",sx:{minHeight:44,minWidth:44},children:(0,U.jsx)(D.A,{})})]})]}),(0,U.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,U.jsx)(l.A,{children:me(e)}),(0,U.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.era||"\u672a\u8bbe\u7f6e\u65f6\u4ee3"})]}),(0,U.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,U.jsx)(c.A,{variant:"body2",fontWeight:"bold",children:"\u53c2\u4e0e\u7edf\u8ba1\uff1a"}),(0,U.jsxs)(c.A,{variant:"body2",children:[e.total_statements," \u53d1\u8a00 \u2022 ",e.total_meetings," \u4f1a\u8bae"]})]}),e.expertise_areas&&(0,U.jsxs)(l.A,{sx:{mb:1},children:[(0,U.jsx)(c.A,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:"\u4e13\u4e1a\u9886\u57df\uff1a"}),(0,U.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:("string"===typeof e.expertise_areas?JSON.parse(e.expertise_areas):e.expertise_areas).map((e,s)=>(0,U.jsx)(a.A,{label:e,size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}},s))})]}),(0,U.jsxs)(c.A,{variant:"caption",color:"text.secondary",children:["\u521b\u5efa\u4e8e ",(0,O.A)(new Date(e.created_at),"yyyy-MM-dd HH:mm",{locale:q.A})]})]})})},e.id))}),(0,U.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,U.jsx)(b.A,{component:"div",count:he,page:Y,onPageChange:(e,s)=>K(s),rowsPerPage:X,onRowsPerPageChange:e=>{$(parseInt(e.target.value,10)),K(0)},rowsPerPageOptions:[5,10,25],labelRowsPerPage:"\u6bcf\u9875:",labelDisplayedRows:e=>{let{from:s,to:t,count:r}=e;return"".concat(s,"-").concat(t," / ").concat(r)},sx:{"& .MuiTablePagination-toolbar":{paddingLeft:1,paddingRight:1},"& .MuiTablePagination-selectLabel, & .MuiTablePagination-displayedRows":{fontSize:"0.875rem"}}})})]})}),(0,U.jsxs)(I.A,{anchorEl:ne.anchorEl,open:Boolean(ne.anchorEl),onClose:()=>le({anchorEl:null,director:null}),children:[(0,U.jsx)(W.A,{onClick:()=>{t("/directors/details/".concat(ne.director.id)),le({anchorEl:null,director:null})},children:"\u67e5\u770b\u7edf\u8ba1"}),(0,U.jsx)(W.A,{onClick:()=>{t("/directors/details/".concat(ne.director.id)),le({anchorEl:null,director:null})},children:"\u67e5\u770b\u8be6\u60c5"}),(0,U.jsx)(W.A,{onClick:()=>{ae({open:!0,director:ne.director}),le({anchorEl:null,director:null})},sx:{color:"error.main"},children:"\u5220\u9664\u8463\u4e8b"})]}),(0,U.jsxs)(S.A,{open:ie.open,onClose:()=>ae({open:!1,director:null}),children:[(0,U.jsx)(z.A,{children:"\u786e\u8ba4\u5220\u9664"}),(0,U.jsx)(P.A,{children:(0,U.jsxs)(c.A,{children:['\u786e\u5b9a\u8981\u5220\u9664\u8463\u4e8b "',null===(s=ie.director)||void 0===s?void 0:s.name,'" \u5417\uff1f \u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u9500\u3002']})}),(0,U.jsxs)(M.A,{children:[(0,U.jsx)(o.A,{onClick:()=>ae({open:!1,director:null}),children:"\u53d6\u6d88"}),(0,U.jsx)(o.A,{color:"error",onClick:()=>Ae.mutate(ie.director.id),disabled:Ae.isLoading,children:Ae.isLoading?"\u5220\u9664\u4e2d...":"\u786e\u8ba4\u5220\u9664"})]})]})]})}}}]);