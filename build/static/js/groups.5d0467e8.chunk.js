"use strict";(self.webpackChunkdongshihui_frontend=self.webpackChunkdongshihui_frontend||[]).push([[583],{760:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3235),i=s(4414);const n=(0,r.A)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},7069:(e,t,s)=>{s.r(t),s.d(t,{default:()=>q});var r=s(9950),i=s(9808),n=s(2053),a=s(6491),o=s(8216),l=s(3174),c=s(899),d=s(8089),h=s(704),u=s(5333),x=s(5277),m=s(3464),A=s(33),j=s(8170),p=s(9925),y=s(249),g=s(4446),v=s(3038),f=s(8587),b=s(8168),w=s(2004),C=s(8465),S=s(3372),k=s(9254),I=s(8463),_=s(1763),W=s(423);function M(e){return(0,W.Ay)("MuiListItemAvatar",e)}(0,_.A)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var z=s(4414);const T=["className"],L=(0,k.Ay)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,"flex-start"===s.alignItems&&t.alignItemsFlexStart]}})(e=>{let{ownerState:t}=e;return(0,b.A)({minWidth:56,flexShrink:0},"flex-start"===t.alignItems&&{marginTop:8})}),N=r.forwardRef(function(e,t){const s=(0,I.b)({props:e,name:"MuiListItemAvatar"}),{className:i}=s,n=(0,f.A)(s,T),a=r.useContext(S.A),o=(0,b.A)({},s,{alignItems:a.alignItems}),l=(e=>{const{alignItems:t,classes:s}=e,r={root:["root","flex-start"===t&&"alignItemsFlexStart"]};return(0,C.A)(r,M,s)})(o);return(0,z.jsx)(L,(0,b.A)({className:(0,w.A)(l.root,i),ownerState:o,ref:t},n))});var E=s(1413),O=s(3563),R=s(9739),D=s(3256),F=s(760),H=s(6724),B=s(7920),J=s(8429),P=s(1521),V=s(922),Z=s(5887);const q=()=>{const e=(0,J.Zp)(),[t,s]=(0,r.useState)([]),[f,b]=(0,r.useState)([]),[w,C]=(0,r.useState)(!0),[S,k]=(0,r.useState)(!1),[I,_]=(0,r.useState)(!1),[W,M]=(0,r.useState)(null),[T,L]=(0,r.useState)(""),[q,G]=(0,r.useState)(""),[K,Q]=(0,r.useState)([]),[U,X]=(0,r.useState)(""),[Y,$]=(0,r.useState)("");(0,r.useEffect)(()=>{ee(),te()},[]);const ee=async()=>{try{const e=await fetch("https://dongshihui-api.jieshu2023.workers.dev/director-groups?user_id=default_user"),t=await e.json();t.success&&s(t.data)}catch(e){console.error("\u83b7\u53d6\u8463\u4e8b\u7ec4\u5408\u5931\u8d25:",e),Z.Ay.error("\u83b7\u53d6\u8463\u4e8b\u7ec4\u5408\u5931\u8d25")}finally{C(!1)}},te=async()=>{try{const e=await fetch("https://dongshihui-api.jieshu2023.workers.dev/directors"),t=await e.json();t.success&&b(t.data)}catch(e){console.error("\u83b7\u53d6\u8463\u4e8b\u5217\u8868\u5931\u8d25:",e)}},se=()=>{L(""),G(""),Q([])};return w?(0,z.jsx)(i.A,{maxWidth:"lg",sx:{py:4},children:(0,z.jsx)(n.A,{variant:"h6",children:"\u52a0\u8f7d\u4e2d..."})}):(0,z.jsxs)(i.A,{maxWidth:"lg",sx:{py:3},children:[(0,z.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,z.jsx)(n.A,{variant:"h4",component:"h1",children:"\u6211\u7684\u8463\u4e8b\u7ec4\u5408"}),(0,z.jsx)(o.A,{variant:"contained",startIcon:(0,z.jsx)(D.A,{}),onClick:()=>k(!0),children:"\u521b\u5efa\u65b0\u7ec4\u5408"})]}),0===t.length?(0,z.jsx)(l.A,{severity:"info",sx:{textAlign:"center"},children:"\u8fd8\u6ca1\u6709\u521b\u5efa\u4efb\u4f55\u8463\u4e8b\u7ec4\u5408\uff0c\u521b\u5efa\u4e00\u4e2a\u4e13\u5c5e\u7684\u8463\u4e8b\u4f1a\u5427\uff01"}):(0,z.jsx)(c.Ay,{container:!0,spacing:3,children:t.map(t=>(0,z.jsx)(c.Ay,{item:!0,xs:12,md:6,lg:4,children:(0,z.jsx)(d.A,{sx:{height:"100%"},children:(0,z.jsxs)(h.A,{children:[(0,z.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[(0,z.jsx)(n.A,{variant:"h6",component:"h3",children:t.name}),(0,z.jsx)(u.A,{size:"small",color:"error",onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e2a\u8463\u4e8b\u7ec4\u5408\u5417\uff1f"))try{const t=await fetch("https://dongshihui-api.jieshu2023.workers.dev/director-groups/".concat(e,"?user_id=default_user"),{method:"DELETE"}),s=await t.json();s.success?(Z.Ay.success("\u8463\u4e8b\u7ec4\u5408\u5220\u9664\u6210\u529f"),ee()):Z.Ay.error(s.error||"\u5220\u9664\u5931\u8d25")}catch(t){console.error("\u5220\u9664\u7ec4\u5408\u5931\u8d25:",t),Z.Ay.error("\u5220\u9664\u7ec4\u5408\u5931\u8d25")}})(t.id),children:(0,z.jsx)(F.A,{})})]}),t.description&&(0,z.jsx)(n.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.description}),(0,z.jsxs)(a.A,{sx:{display:"flex",gap:1,mb:2},children:[(0,z.jsx)(x.A,{label:"".concat(t.member_count," \u4f4d\u8463\u4e8b"),size:"small",color:"primary",variant:"outlined"}),(0,z.jsx)(x.A,{label:"\u4f7f\u7528 ".concat(t.usage_count," \u6b21"),size:"small",variant:"outlined"})]}),(0,z.jsxs)(n.A,{variant:"caption",color:"text.secondary",display:"block",sx:{mb:2},children:["\u521b\u5efa\u4e8e ",(0,P.A)(new Date(t.created_at),"yyyy\u5e74MM\u6708dd\u65e5",{locale:V.A})]}),(0,z.jsxs)(a.A,{sx:{display:"flex",gap:1},children:[(0,z.jsx)(o.A,{variant:"contained",size:"small",startIcon:(0,z.jsx)(H.A,{}),onClick:()=>{M(t),_(!0)},sx:{flex:1},children:"\u521b\u5efa\u4f1a\u8bae"}),(0,z.jsx)(o.A,{variant:"outlined",size:"small",startIcon:(0,z.jsx)(B.A,{}),onClick:()=>e("/director-groups/".concat(t.id)),children:"\u67e5\u770b\u8be6\u60c5"})]})]})})},t.id))}),(0,z.jsxs)(m.A,{open:S,onClose:()=>k(!1),maxWidth:"md",fullWidth:!0,children:[(0,z.jsx)(A.A,{children:"\u521b\u5efa\u8463\u4e8b\u7ec4\u5408"}),(0,z.jsxs)(j.A,{children:[(0,z.jsx)(p.A,{fullWidth:!0,label:"\u7ec4\u5408\u540d\u79f0",value:T,onChange:e=>L(e.target.value),sx:{mb:2,mt:1}}),(0,z.jsx)(p.A,{fullWidth:!0,multiline:!0,rows:2,label:"\u7ec4\u5408\u63cf\u8ff0\uff08\u53ef\u9009\uff09",value:q,onChange:e=>G(e.target.value),sx:{mb:3}}),(0,z.jsx)(n.A,{variant:"subtitle1",gutterBottom:!0,children:"\u9009\u62e9\u8463\u4e8b\u6210\u5458\uff1a"}),(0,z.jsx)(y.A,{sx:{maxHeight:300,overflow:"auto"},children:f.map(e=>{var t;return(0,z.jsxs)(g.Ay,{dense:!0,button:!0,onClick:()=>{return t=e.id,void Q(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[(0,z.jsx)(v.A,{checked:K.includes(e.id),tabIndex:-1,disableRipple:!0}),(0,z.jsx)(N,{children:(0,z.jsx)(E.A,{src:e.avatar_url,children:null===(t=e.name)||void 0===t?void 0:t[0]})}),(0,z.jsx)(O.A,{primary:e.name,secondary:"".concat(e.title," \xb7 ").concat(e.era)})]},e.id)})}),(0,z.jsxs)(n.A,{variant:"caption",color:"text.secondary",children:["\u5df2\u9009\u62e9 ",K.length," \u4f4d\u8463\u4e8b"]})]}),(0,z.jsxs)(R.A,{children:[(0,z.jsx)(o.A,{onClick:()=>{k(!1),se()},children:"\u53d6\u6d88"}),(0,z.jsx)(o.A,{onClick:async()=>{if(T.trim()&&0!==K.length)try{const e=await fetch("https://dongshihui-api.jieshu2023.workers.dev/director-groups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:T.trim(),description:q.trim(),director_ids:K,user_id:"default_user"})}),t=await e.json();t.success?(Z.Ay.success("\u8463\u4e8b\u7ec4\u5408\u521b\u5efa\u6210\u529f\uff01"),k(!1),se(),ee()):Z.Ay.error(t.error||"\u521b\u5efa\u5931\u8d25")}catch(e){console.error("\u521b\u5efa\u7ec4\u5408\u5931\u8d25:",e),Z.Ay.error("\u521b\u5efa\u7ec4\u5408\u5931\u8d25")}else Z.Ay.error("\u8bf7\u586b\u5199\u7ec4\u5408\u540d\u79f0\u5e76\u9009\u62e9\u81f3\u5c11\u4e00\u4f4d\u8463\u4e8b")},variant:"contained",disabled:!T.trim()||0===K.length,children:"\u521b\u5efa\u7ec4\u5408"})]})]}),(0,z.jsxs)(m.A,{open:I,onClose:()=>_(!1),maxWidth:"sm",fullWidth:!0,children:[(0,z.jsxs)(A.A,{children:['\u57fa\u4e8e "',null===W||void 0===W?void 0:W.name,'" \u521b\u5efa\u4f1a\u8bae']}),(0,z.jsxs)(j.A,{children:[(0,z.jsx)(p.A,{fullWidth:!0,label:"\u4f1a\u8bae\u6807\u9898",value:U,onChange:e=>X(e.target.value),sx:{mb:2,mt:1}}),(0,z.jsx)(p.A,{fullWidth:!0,multiline:!0,rows:3,label:"\u8ba8\u8bba\u8bdd\u9898",value:Y,onChange:e=>$(e.target.value),placeholder:"\u8bf7\u8f93\u5165\u8981\u8ba8\u8bba\u7684\u8bdd\u9898..."}),W&&(0,z.jsx)(a.A,{sx:{mt:2},children:(0,z.jsxs)(n.A,{variant:"subtitle2",gutterBottom:!0,children:["\u5c06\u9080\u8bf7 ",W.member_count," \u4f4d\u8463\u4e8b\u53c2\u4e0e\u8ba8\u8bba"]})})]}),(0,z.jsxs)(R.A,{children:[(0,z.jsx)(o.A,{onClick:()=>{_(!1),X(""),$("")},children:"\u53d6\u6d88"}),(0,z.jsx)(o.A,{onClick:async()=>{if(U.trim()&&Y.trim())try{const t=await fetch("https://dongshihui-api.jieshu2023.workers.dev/meetings/from-group/".concat(W.id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:U.trim(),topic:Y.trim(),discussion_mode:"round_robin",max_rounds:10})}),s=await t.json();s.success?(Z.Ay.success("\u4f1a\u8bae\u521b\u5efa\u6210\u529f\uff01"),_(!1),X(""),$(""),e("/meeting/".concat(s.data.id))):Z.Ay.error(s.error||"\u521b\u5efa\u4f1a\u8bae\u5931\u8d25")}catch(t){console.error("\u521b\u5efa\u4f1a\u8bae\u5931\u8d25:",t),Z.Ay.error("\u521b\u5efa\u4f1a\u8bae\u5931\u8d25")}else Z.Ay.error("\u8bf7\u586b\u5199\u4f1a\u8bae\u6807\u9898\u548c\u8bdd\u9898")},variant:"contained",disabled:!U.trim()||!Y.trim(),children:"\u521b\u5efa\u4f1a\u8bae"})]})]})]})}}}]);