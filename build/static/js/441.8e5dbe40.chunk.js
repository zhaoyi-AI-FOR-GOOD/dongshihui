"use strict";(self.webpackChunkdongshihui_frontend=self.webpackChunkdongshihui_frontend||[]).push([[441],{7441:(e,s,n)=>{n.r(s),n.d(s,{default:()=>G});var r=n(9950),t=n(6589),i=n(5277),l=n(9808),a=n(6491),c=n(2053),o=n(8216),d=n(2235),x=n(9925),h=n(2046),A=n(1408),j=n(1320),u=n(5769),g=n(9780),m=n(9213),p=n(1671),y=n(3038),f=n(4075),b=n(1413),v=n(5333),w=n(1434),C=n(899),k=n(8089),P=n(704),_=n(5365),z=n(3266),S=n(3464),E=n(33),I=n(8170),W=n(9739),H=n(4857),D=n(3256),L=n(379),M=n(6281),R=n(294),T=n(9715),O=n(5810),Q=n(1920),V=n(8429),B=n(1521),J=n(922),N=n(5887),U=n(9181),F=n(4414);const G=()=>{var e,s;const n=(0,V.Zp)(),G=(0,Q.useQueryClient)(),Y=(0,H.A)(),Z=(0,t.A)(Y.breakpoints.down("md")),[q,K]=(0,r.useState)(0),[X,$]=(0,r.useState)(10),[ee,se]=(0,r.useState)(""),[ne,re]=(0,r.useState)([]),[te,ie]=(0,r.useState)({open:!1,director:null}),[le,ae]=(0,r.useState)({anchorEl:null,director:null}),{data:ce,isLoading:oe}=(0,Q.useQuery)(["directors",q,X,ee],()=>U.hV.getAll(),{onError:e=>{N.Ay.error("\u83b7\u53d6\u8463\u4e8b\u5217\u8868\u5931\u8d25: "+e.message)}}),de=((null===ce||void 0===ce||null===(e=ce.data)||void 0===e?void 0:e.data)||[]).filter(e=>!ee||e.name.toLowerCase().includes(ee.toLowerCase())||e.title.toLowerCase().includes(ee.toLowerCase())),xe=de.slice(q*X,(q+1)*X),he=de.length,Ae=(0,Q.useMutation)(e=>U.hV.delete(e),{onSuccess:()=>{N.Ay.success("\u8463\u4e8b\u5220\u9664\u6210\u529f"),G.invalidateQueries("directors"),ie({open:!1,director:null})},onError:e=>{N.Ay.error("\u5220\u9664\u5931\u8d25: "+e.message)}}),je=(0,Q.useMutation)(e=>{let{ids:s,status:n,isActive:r}=e;return U.hV.batchUpdateStatus(s,n,r)},{onSuccess:e=>{N.Ay.success("\u6210\u529f\u66f4\u65b0 ".concat(e.data.updated_count," \u4e2a\u8463\u4e8b")),G.invalidateQueries("directors"),re([])},onError:e=>{N.Ay.error("\u6279\u91cf\u66f4\u65b0\u5931\u8d25: "+e.message)}}),ue=e=>{re(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},ge=e=>{if(!e.is_active)return(0,F.jsx)(i.A,{label:"\u5df2\u7981\u7528",color:"error",size:"small"});switch(e.status){case"active":return(0,F.jsx)(i.A,{label:"\u6d3b\u8dc3",color:"success",size:"small"});case"inactive":return(0,F.jsx)(i.A,{label:"\u975e\u6d3b\u8dc3",color:"warning",size:"small"});case"retired":return(0,F.jsx)(i.A,{label:"\u5df2\u9000\u4f11",color:"default",size:"small"});default:return(0,F.jsx)(i.A,{label:e.status,color:"default",size:"small"})}};return(0,F.jsxs)(l.A,{maxWidth:"lg",sx:{py:Z?2:4},children:[(0,F.jsxs)(a.A,{sx:{display:"flex",flexDirection:Z?"column":"row",justifyContent:"space-between",alignItems:Z?"stretch":"center",gap:Z?2:0,mb:Z?3:4},children:[(0,F.jsx)(c.A,{variant:Z?"h5":"h4",component:"h1",children:"\u8463\u4e8b\u7ba1\u7406"}),(0,F.jsxs)(a.A,{sx:{display:"flex",gap:Z?1:2,flexDirection:Z?"column":"row"},children:[(0,F.jsx)(o.A,{variant:"outlined",startIcon:(0,F.jsx)(O.A,{}),onClick:()=>(0,N.Ay)("\u6279\u91cf\u5bfc\u5165\u529f\u80fd\u5f00\u53d1\u4e2d..."),size:Z?"large":"medium",fullWidth:Z,sx:{minHeight:Z?48:"auto"},children:"\u6279\u91cf\u5bfc\u5165"}),(0,F.jsx)(o.A,{variant:"contained",startIcon:(0,F.jsx)(D.A,{}),onClick:()=>n("/directors/create"),size:Z?"large":"medium",fullWidth:Z,sx:{minHeight:Z?48:"auto"},children:"\u521b\u5efa\u8463\u4e8b"})]})]}),(0,F.jsxs)(d.A,{sx:{p:Z?2:3,mb:Z?2:3},children:[(0,F.jsx)(a.A,{sx:{display:"flex",gap:2,alignItems:"center",mb:2,flexDirection:Z?"column":"row"},children:(0,F.jsx)(x.A,{placeholder:"\u641c\u7d22\u8463\u4e8b\u59d3\u540d\u6216\u8eab\u4efd...",value:ee,onChange:e=>{se(e.target.value),K(0)},InputProps:{startAdornment:(0,F.jsx)(h.A,{position:"start",children:(0,F.jsx)(T.A,{})})},sx:{flexGrow:1},fullWidth:Z,size:"medium"})}),ne.length>0&&(0,F.jsxs)(a.A,{sx:{display:"flex",gap:Z?1:2,alignItems:"center",flexDirection:Z?"column":"row",alignItems:Z?"stretch":"center"},children:[(0,F.jsxs)(c.A,{variant:"body2",sx:{textAlign:Z?"center":"left"},children:["\u5df2\u9009\u62e9 ",ne.length," \u4e2a\u8463\u4e8b"]}),(0,F.jsxs)(a.A,{sx:{display:"flex",gap:1,flexDirection:Z?"column":"row",width:Z?"100%":"auto"},children:[(0,F.jsx)(o.A,{size:Z?"medium":"small",onClick:()=>je.mutate({ids:ne,is_active:!1}),fullWidth:Z,sx:{minHeight:Z?44:"auto"},children:"\u6279\u91cf\u7981\u7528"}),(0,F.jsx)(o.A,{size:Z?"medium":"small",onClick:()=>je.mutate({ids:ne,is_active:!0,status:"active"}),fullWidth:Z,sx:{minHeight:Z?44:"auto"},children:"\u6279\u91cf\u542f\u7528"}),(0,F.jsx)(o.A,{size:Z?"medium":"small",color:"error",onClick:()=>{N.Ay.error("\u6279\u91cf\u5220\u9664\u529f\u80fd\u9700\u8981\u4e8c\u6b21\u786e\u8ba4")},fullWidth:Z,sx:{minHeight:Z?44:"auto"},children:"\u6279\u91cf\u5220\u9664"})]})]})]}),(0,F.jsx)(A.A,{mdDown:!0,children:(0,F.jsxs)(j.A,{component:d.A,children:[(0,F.jsxs)(u.A,{children:[(0,F.jsx)(g.A,{children:(0,F.jsxs)(m.A,{children:[(0,F.jsx)(p.A,{padding:"checkbox",children:(0,F.jsx)(y.A,{indeterminate:ne.length>0&&ne.length<xe.length,checked:xe.length>0&&ne.length===xe.length,onChange:e=>{e.target.checked?re(xe.map(e=>e.id)):re([])}})}),(0,F.jsx)(p.A,{children:"\u8463\u4e8b"}),(0,F.jsx)(p.A,{children:"\u8eab\u4efd"}),(0,F.jsx)(p.A,{children:"\u65f6\u4ee3"}),(0,F.jsx)(p.A,{children:"\u72b6\u6001"}),(0,F.jsx)(p.A,{align:"center",children:"\u7edf\u8ba1"}),(0,F.jsx)(p.A,{children:"\u521b\u5efa\u65f6\u95f4"}),(0,F.jsx)(p.A,{align:"center",children:"\u64cd\u4f5c"})]})}),(0,F.jsx)(f.A,{children:oe?[...Array(5)].map((e,s)=>(0,F.jsx)(m.A,{children:(0,F.jsx)(p.A,{colSpan:8,sx:{textAlign:"center",py:4},children:"\u52a0\u8f7d\u4e2d..."})},s)):0===xe.length?(0,F.jsx)(m.A,{children:(0,F.jsxs)(p.A,{colSpan:8,sx:{textAlign:"center",py:8},children:[(0,F.jsx)(R.A,{sx:{fontSize:48,color:"text.secondary",mb:2}}),(0,F.jsx)(c.A,{variant:"body1",color:"text.secondary",children:ee?"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u8463\u4e8b":'\u8fd8\u6ca1\u6709\u8463\u4e8b\uff0c\u70b9\u51fb"\u521b\u5efa\u8463\u4e8b"\u5f00\u59cb\u6dfb\u52a0'})]})}):xe.map(e=>(0,F.jsxs)(m.A,{selected:ne.includes(e.id),children:[(0,F.jsx)(p.A,{padding:"checkbox",children:(0,F.jsx)(y.A,{checked:ne.includes(e.id),onChange:()=>ue(e.id)})}),(0,F.jsx)(p.A,{children:(0,F.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,F.jsx)(b.A,{src:e.avatar_url,sx:{width:40,height:40},children:(0,F.jsx)(R.A,{})}),(0,F.jsxs)(a.A,{children:[(0,F.jsx)(c.A,{variant:"subtitle2",children:e.name}),e.expertise_areas&&(0,F.jsx)(c.A,{variant:"caption",color:"text.secondary",children:("string"===typeof e.expertise_areas?JSON.parse(e.expertise_areas):e.expertise_areas).slice(0,2).join(", ")})]})]})}),(0,F.jsx)(p.A,{children:(0,F.jsx)(c.A,{variant:"body2",children:e.title})}),(0,F.jsx)(p.A,{children:(0,F.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.era||"-"})}),(0,F.jsx)(p.A,{children:ge(e)}),(0,F.jsx)(p.A,{align:"center",children:(0,F.jsxs)(a.A,{children:[(0,F.jsxs)(c.A,{variant:"body2",children:[e.total_statements," \u53d1\u8a00"]}),(0,F.jsxs)(c.A,{variant:"caption",color:"text.secondary",children:[e.total_meetings," \u4f1a\u8bae"]})]})}),(0,F.jsx)(p.A,{children:(0,F.jsx)(c.A,{variant:"body2",color:"text.secondary",children:(0,B.A)(new Date(e.created_at),"yyyy-MM-dd HH:mm",{locale:J.A})})}),(0,F.jsxs)(p.A,{align:"center",children:[(0,F.jsx)(v.A,{onClick:()=>n("/directors/edit/".concat(e.id)),title:"\u7f16\u8f91\u8463\u4e8b",children:(0,F.jsx)(L.A,{})}),(0,F.jsx)(v.A,{onClick:s=>ae({anchorEl:s.currentTarget,director:e}),title:"\u66f4\u591a\u64cd\u4f5c",children:(0,F.jsx)(M.A,{})})]})]},e.id))})]}),(0,F.jsx)(w.A,{component:"div",count:he,page:q,onPageChange:(e,s)=>K(s),rowsPerPage:X,onRowsPerPageChange:e=>{$(parseInt(e.target.value,10)),K(0)},rowsPerPageOptions:[5,10,25,50],labelRowsPerPage:"\u6bcf\u9875\u663e\u793a:",labelDisplayedRows:e=>{let{from:s,to:n,count:r}=e;return"".concat(s,"-").concat(n," \u5171 ").concat(r," \u6761")}})]})}),(0,F.jsx)(A.A,{mdUp:!0,children:oe?(0,F.jsx)(d.A,{sx:{p:4,textAlign:"center"},children:(0,F.jsx)(c.A,{variant:"h6",children:"\u52a0\u8f7d\u8463\u4e8b\u5217\u8868\u4e2d..."})}):0===xe.length?(0,F.jsxs)(d.A,{sx:{p:6,textAlign:"center"},children:[(0,F.jsx)(R.A,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,F.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:ee?"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u8463\u4e8b":"\u8fd8\u6ca1\u6709\u8463\u4e8b"}),(0,F.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:ee?"\u5c1d\u8bd5\u8c03\u6574\u641c\u7d22\u6761\u4ef6":"\u521b\u5efa\u7b2c\u4e00\u4e2a\u8463\u4e8b\u5f00\u59cb\u7ba1\u7406"}),(0,F.jsx)(o.A,{variant:"contained",onClick:()=>n("/directors/create"),children:"\u521b\u5efa\u8463\u4e8b"})]}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(C.Ay,{container:!0,spacing:2,children:xe.map(e=>(0,F.jsx)(C.Ay,{item:!0,xs:12,children:(0,F.jsx)(k.A,{sx:{transition:"all 0.2s ease","&:hover":{boxShadow:"0 6px 20px rgba(0,0,0,0.1)",transform:"translateY(-2px)"}},children:(0,F.jsxs)(P.A,{sx:{p:2.5},children:[(0,F.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,F.jsx)(y.A,{checked:ne.includes(e.id),onChange:()=>ue(e.id),sx:{mr:1}}),(0,F.jsx)(b.A,{src:e.avatar_url,sx:{width:48,height:48,mr:2},children:(0,F.jsx)(R.A,{})}),(0,F.jsxs)(a.A,{sx:{flex:1},children:[(0,F.jsx)(c.A,{variant:"h6",sx:{fontWeight:600,fontSize:"1.1rem"},children:e.name}),(0,F.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.title})]}),(0,F.jsxs)(a.A,{sx:{display:"flex",gap:1},children:[(0,F.jsx)(v.A,{onClick:()=>n("/directors/edit/".concat(e.id)),title:"\u7f16\u8f91\u8463\u4e8b",size:"large",sx:{minHeight:44,minWidth:44},children:(0,F.jsx)(L.A,{})}),(0,F.jsx)(v.A,{onClick:s=>ae({anchorEl:s.currentTarget,director:e}),title:"\u66f4\u591a\u64cd\u4f5c",size:"large",sx:{minHeight:44,minWidth:44},children:(0,F.jsx)(M.A,{})})]})]}),(0,F.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,F.jsx)(a.A,{children:ge(e)}),(0,F.jsx)(c.A,{variant:"body2",color:"text.secondary",children:e.era||"\u672a\u8bbe\u7f6e\u65f6\u4ee3"})]}),(0,F.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,F.jsx)(c.A,{variant:"body2",fontWeight:"bold",children:"\u53c2\u4e0e\u7edf\u8ba1\uff1a"}),(0,F.jsxs)(c.A,{variant:"body2",children:[e.total_statements," \u53d1\u8a00 \u2022 ",e.total_meetings," \u4f1a\u8bae"]})]}),e.expertise_areas&&(0,F.jsxs)(a.A,{sx:{mb:1},children:[(0,F.jsx)(c.A,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:"\u4e13\u4e1a\u9886\u57df\uff1a"}),(0,F.jsx)(a.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:("string"===typeof e.expertise_areas?JSON.parse(e.expertise_areas):e.expertise_areas).map((e,s)=>(0,F.jsx)(i.A,{label:e,size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}},s))})]}),(0,F.jsxs)(c.A,{variant:"caption",color:"text.secondary",children:["\u521b\u5efa\u4e8e ",(0,B.A)(new Date(e.created_at),"yyyy-MM-dd HH:mm",{locale:J.A})]})]})})},e.id))}),(0,F.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,F.jsx)(w.A,{component:"div",count:he,page:q,onPageChange:(e,s)=>K(s),rowsPerPage:X,onRowsPerPageChange:e=>{$(parseInt(e.target.value,10)),K(0)},rowsPerPageOptions:[5,10,25],labelRowsPerPage:"\u6bcf\u9875:",labelDisplayedRows:e=>{let{from:s,to:n,count:r}=e;return"".concat(s,"-").concat(n," / ").concat(r)},sx:{"& .MuiTablePagination-toolbar":{paddingLeft:1,paddingRight:1},"& .MuiTablePagination-selectLabel, & .MuiTablePagination-displayedRows":{fontSize:"0.875rem"}}})})]})}),(0,F.jsxs)(_.A,{anchorEl:le.anchorEl,open:Boolean(le.anchorEl),onClose:()=>ae({anchorEl:null,director:null}),children:[(0,F.jsx)(z.A,{onClick:()=>{n("/directors/details/".concat(le.director.id)),ae({anchorEl:null,director:null})},children:"\u67e5\u770b\u7edf\u8ba1"}),(0,F.jsx)(z.A,{onClick:()=>{n("/directors/details/".concat(le.director.id)),ae({anchorEl:null,director:null})},children:"\u67e5\u770b\u8be6\u60c5"}),(0,F.jsx)(z.A,{onClick:()=>{ie({open:!0,director:le.director}),ae({anchorEl:null,director:null})},sx:{color:"error.main"},children:"\u5220\u9664\u8463\u4e8b"})]}),(0,F.jsxs)(S.A,{open:te.open,onClose:()=>ie({open:!1,director:null}),children:[(0,F.jsx)(E.A,{children:"\u786e\u8ba4\u5220\u9664"}),(0,F.jsx)(I.A,{children:(0,F.jsxs)(c.A,{children:['\u786e\u5b9a\u8981\u5220\u9664\u8463\u4e8b "',null===(s=te.director)||void 0===s?void 0:s.name,'" \u5417\uff1f \u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u9500\u3002']})}),(0,F.jsxs)(W.A,{children:[(0,F.jsx)(o.A,{onClick:()=>ie({open:!1,director:null}),children:"\u53d6\u6d88"}),(0,F.jsx)(o.A,{color:"error",onClick:()=>Ae.mutate(te.director.id),disabled:Ae.isLoading,children:Ae.isLoading?"\u5220\u9664\u4e2d...":"\u786e\u8ba4\u5220\u9664"})]})]})]})}}}]);