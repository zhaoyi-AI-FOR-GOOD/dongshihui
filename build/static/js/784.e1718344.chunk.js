"use strict";(self.webpackChunkdongshihui_frontend=self.webpackChunkdongshihui_frontend||[]).push([[784],{4784:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var i=s(9950),r=s(9808),l=s(2053),n=s(6491),a=s(8216),o=s(2235),c=s(9925),d=s(5277),h=s(1966),x=s(4142),u=s(3174),v=s(899),m=s(8089),A=s(704),j=s(1413),f=s(4745),y=s(5333),p=s(760),g=s(9715),b=s(6904),w=s(1521),C=s(922),k=s(5887),_=s(8429),S=s(4414);const L=()=>{const e=(0,_.Zp)(),[t,s]=(0,i.useState)([]),[L,z]=(0,i.useState)([]),[E,I]=(0,i.useState)(!0),[W,H]=(0,i.useState)(0),[D,M]=(0,i.useState)(""),[T,B]=(0,i.useState)([]),[P,R]=(0,i.useState)([]),Z=[{value:"all",label:"\u5168\u90e8\u6536\u85cf"},{value:"statement",label:"\u4f1a\u8bae\u53d1\u8a00"},{value:"response",label:"\u95ee\u9898\u56de\u5e94"}];(0,i.useEffect)(()=>{q(),F()},[]),(0,i.useEffect)(()=>{G()},[t,W,D,T]);const q=async()=>{try{const e=await fetch("https://dongshihui-api.jieshu2023.workers.dev/favorites?user_id=default_user"),t=await e.json();t.success?s(t.data):k.Ay.error("\u83b7\u53d6\u6536\u85cf\u5931\u8d25")}catch(e){console.error("\u83b7\u53d6\u6536\u85cf\u5931\u8d25:",e),k.Ay.error("\u83b7\u53d6\u6536\u85cf\u5931\u8d25")}finally{I(!1)}},F=async()=>{try{const e=await fetch("https://dongshihui-api.jieshu2023.workers.dev/favorites/tags?user_id=default_user"),t=await e.json();t.success&&R(t.data)}catch(e){console.error("\u83b7\u53d6\u6807\u7b7e\u5931\u8d25:",e)}},G=()=>{let e=t;if(W>0){const t=Z[W].value;e=e.filter(e=>e.favorite_type===t)}if(D.trim()){const t=D.toLowerCase();e=e.filter(e=>{var s,i,r,l,n;return(null===(s=e.content)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(i=e.director)||void 0===i||null===(r=i.name)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(l=e.meeting)||void 0===l||null===(n=l.title)||void 0===n?void 0:n.toLowerCase().includes(t))})}T.length>0&&(e=e.filter(e=>T.some(t=>e.tags.includes(t)))),z(e)};return E?(0,S.jsx)(r.A,{maxWidth:"lg",sx:{py:4},children:(0,S.jsx)(l.A,{variant:"h6",children:"\u52a0\u8f7d\u6536\u85cf\u4e2d..."})}):(0,S.jsxs)(r.A,{maxWidth:"lg",sx:{py:3},children:[(0,S.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,S.jsx)(l.A,{variant:"h4",component:"h1",children:"\u6211\u7684\u6536\u85cf"}),(0,S.jsx)(a.A,{onClick:()=>e("/hall"),children:"\u8fd4\u56de\u5927\u5385"})]}),(0,S.jsxs)(o.A,{sx:{p:2,mb:3},children:[(0,S.jsx)(n.A,{sx:{display:"flex",gap:2,mb:2},children:(0,S.jsx)(c.A,{size:"small",placeholder:"\u641c\u7d22\u6536\u85cf\u5185\u5bb9...",value:D,onChange:e=>M(e.target.value),InputProps:{startAdornment:(0,S.jsx)(g.A,{sx:{mr:1,color:"text.secondary"}})},sx:{flex:1}})}),P.length>0&&(0,S.jsxs)(n.A,{children:[(0,S.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:"\u6309\u6807\u7b7e\u7b5b\u9009\uff1a"}),(0,S.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:P.map(e=>(0,S.jsx)(d.A,{label:e,onClick:()=>(e=>{T.includes(e)?B(t=>t.filter(t=>t!==e)):B(t=>[...t,e])})(e),color:T.includes(e)?"primary":"default",variant:T.includes(e)?"filled":"outlined",size:"small"},e))})]})]}),(0,S.jsx)(h.A,{value:W,onChange:(e,t)=>H(t),sx:{mb:3},children:Z.map((e,t)=>(0,S.jsx)(x.A,{label:e.label},e.value))}),0===L.length?(0,S.jsx)(u.A,{severity:"info",sx:{textAlign:"center"},children:0===t.length?"\u8fd8\u6ca1\u6709\u6536\u85cf\u4efb\u4f55\u5185\u5bb9":"\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u6536\u85cf"}):(0,S.jsx)(v.Ay,{container:!0,spacing:3,children:L.map(e=>{var t,i,r,a,o,c;return(0,S.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,S.jsx)(m.A,{sx:{height:"100%"},children:(0,S.jsxs)(A.A,{children:[(0,S.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,S.jsx)(j.A,{src:null===(t=e.director)||void 0===t?void 0:t.avatar_url,sx:{width:40,height:40,mr:2},children:null===(i=e.director)||void 0===i||null===(r=i.name)||void 0===r?void 0:r[0]}),(0,S.jsxs)(n.A,{sx:{flex:1},children:[(0,S.jsx)(l.A,{variant:"subtitle1",fontWeight:"bold",children:null===(a=e.director)||void 0===a?void 0:a.name}),(0,S.jsx)(l.A,{variant:"caption",color:"text.secondary",children:null===(o=e.director)||void 0===o?void 0:o.title})]}),(0,S.jsx)(d.A,{label:"statement"===e.favorite_type?"\u4f1a\u8bae\u53d1\u8a00":"\u95ee\u9898\u56de\u5e94",size:"small",color:"primary",variant:"outlined"})]}),(0,S.jsxs)(l.A,{variant:"body1",sx:{mb:2,lineHeight:1.6,fontStyle:"italic",backgroundColor:"#f8f9fa",p:2,borderRadius:1,borderLeft:4,borderLeftColor:"primary.main"},children:['"',e.content,'"']}),(null===(c=e.meeting)||void 0===c?void 0:c.title)&&(0,S.jsx)(n.A,{sx:{mb:2},children:(0,S.jsxs)(l.A,{variant:"caption",color:"text.secondary",children:["\u6765\u81ea\u4f1a\u8bae\uff1a",e.meeting.title]})}),e.tags.length>0&&(0,S.jsx)(n.A,{sx:{mb:2},children:e.tags.map(e=>(0,S.jsx)(d.A,{label:e,size:"small",sx:{mr:.5,mb:.5}},e))}),e.notes&&(0,S.jsx)(n.A,{sx:{mb:2},children:(0,S.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:["\u5907\u6ce8\uff1a",e.notes]})}),(0,S.jsx)(f.A,{sx:{mb:2}}),(0,S.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,S.jsxs)(l.A,{variant:"caption",color:"text.secondary",children:["\u6536\u85cf\u4e8e ",(0,w.A)(new Date(e.created_at),"yyyy\u5e74MM\u6708dd\u65e5 HH:mm",{locale:C.A})]}),(0,S.jsxs)(n.A,{children:[(0,S.jsx)(y.A,{size:"small",onClick:()=>(async e=>{var t,s;const i="\u3010".concat(null===(t=e.director)||void 0===t?void 0:t.name,"\u3011").concat(null===(s=e.director)||void 0===s?void 0:s.title,'\n\n"').concat(e.content,'"\n\n\u6765\u81ea\u79c1\u4eba\u8463\u4e8b\u4f1a\u7cfb\u7edf');if(navigator.share)try{var r;await navigator.share({title:"".concat(null===(r=e.director)||void 0===r?void 0:r.name,"\u7684\u7cbe\u5f69\u53d1\u8a00"),text:i,url:window.location.origin})}catch(l){}else try{await navigator.clipboard.writeText(i),k.Ay.success("\u5185\u5bb9\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")}catch(l){k.Ay.error("\u5206\u4eab\u5931\u8d25")}})(e),title:"\u5206\u4eab",children:(0,S.jsx)(b.A,{})}),(0,S.jsx)(y.A,{size:"small",onClick:()=>(async e=>{try{const t=await fetch("https://dongshihui-api.jieshu2023.workers.dev/favorites/".concat(e,"?user_id=default_user"),{method:"DELETE"});(await t.json()).success?(s(t=>t.filter(t=>t.id!==e)),k.Ay.success("\u5df2\u53d6\u6d88\u6536\u85cf")):k.Ay.error("\u53d6\u6d88\u6536\u85cf\u5931\u8d25")}catch(t){console.error("\u53d6\u6d88\u6536\u85cf\u5931\u8d25:",t),k.Ay.error("\u53d6\u6d88\u6536\u85cf\u5931\u8d25")}})(e.id),color:"error",title:"\u53d6\u6d88\u6536\u85cf",children:(0,S.jsx)(p.A,{})})]})]})]})})},e.id)})})]})}}}]);